<html>
<head>
	<script>
	// if they get this or lower catestrophe strikes
	const FAIL_SUM = 4;
	const HOW_MANY_ROUNDS = 5;
	let num = 1;
	function myFunction_score_inc() {
		document.getElementById("myScore").stepUp(1);
	}
	function myFunction_score_dec() {
		document.getElementById("myScore").stepDown(1);
	}
	function myFunction_risk_inc() {
		document.getElementById("myRisk").stepUp(1);
	}
	function myFunction_risk_dec() {
		document.getElementById("myRisk").stepDown(1);
	}
	//https://stackoverflow.com/questions/2956966/javascript-telling-setinterval-to-only-fire-x-amount-of-times
	function setIntervalX(delay, repetitions, roll1, roll2) {

		var x = 0;
		var intervalID = window.setInterval(function () {

			document.getElementById("roll1").innerHTML =
				Math.floor(Math.random() * 6) + 1;
			document.getElementById("roll2").innerHTML =
				Math.floor(Math.random() * 6) + 1;

			if (++x === repetitions) {

				window.clearInterval(intervalID);

				document.getElementById("roll1").innerHTML = roll1;
				document.getElementById("roll2").innerHTML = roll2;
				document.getElementById("roller").disabled = false;
			}
		}, delay);
	}
	function rollIt() {

		document.getElementById("roller").disabled = true;
		// sum in [2, FAIL_SUM]
		let sum = Math.floor(Math.random() * (FAIL_SUM - 1)) + 2;
		// roll1 in [1, sum - 1]
		let roll1 = Math.floor(Math.random() * (sum - 1)) + 1;
		// roll2 in [1, sum - 1]
		let roll2 = sum - roll1;
		if (num == HOW_MANY_ROUNDS) {

			setIntervalX(200, 10, roll1, roll2);
			num += 1
		}
		else if (num < 5) {

			// diff in [1, FAIL_SUM - 1]
			let diff = FAIL_SUM - sum + 1;
			for (let i = 0; i < diff; i++) {
				if (Math.floor(Math.random() * 2) == 0) {

					roll1 += 1;
				}
				else{

					roll2 += 1;
				}
			}
			// roll1 + x, x in [0, 6 - roll1] => [roll1, 6]
			roll1 = roll1 + Math.floor(Math.random() * (7 - roll1));
			// roll2 + x, x in [0, 6 - roll2] => [roll2, 6]
			roll2 = roll2 + Math.floor(Math.random() * (7 - roll2));
			setIntervalX(200, 10, roll1, roll2);
			num += 1
		}
	}
	</script>
</head>
<body>
	<p>Team Name:</p>
	<textarea rows="2" cols="64"></textarea><br>
	Score:<br>
	<button onclick="myFunction_score_inc()">Up</button>
	<input type="number" id="myScore" value=0>
	<button onclick="myFunction_score_dec()">Down</button><br>
	Risk:<br>
	<button onclick="myFunction_risk_inc()">Up</button>
	<input type="number" id="myRisk" value=0>
	<button onclick="myFunction_risk_dec()">Down</button><br>
	<button onclick="rollIt()" id="roller"><h3>ROLL</h3></button><br>
	<h2 id='roll1'></h2>
	<h2 id='roll2'></h2>
	<h1>Overview</h1>
	<p>Each round has two phases: decision phase and investigation phase.</p>
	<p>Roll the dice regardless of if you decide to take the risk. The die only matters in the case of a risky decision.</p>
	<p><b>If your roll totals to 4 or less you fail the action and take any consequences.</b></p>
	<p>In the investigation phase, go to one of us, the safety investigators, in front of the class and publicly announce the decision.</p>
</body>
</html>